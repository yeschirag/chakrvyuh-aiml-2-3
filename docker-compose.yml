version: "3.9"
services:
  server:
    build: ./server
    command: ["node", "src/index.js"]
    ports: ["4000:4000"]
    environment:
      - PORT=4000
      - JWT_SECRET=${JWT_SECRET:-please-change-me}
      - CORS_ORIGIN=${CORS_ORIGIN:-http://localhost:5173}
      - ADMIN_TOKEN=${ADMIN_TOKEN:-please-change-admin}
    volumes:
      - ./server/src:/usr/src/app/src
  web:
    build: ./web
    command: ["npm", "run", "dev", "--", "--host"]
    ports: ["5173:5173"]
    environment:
      - VITE_API_BASE=http://localhost:4000
    volumes:
      - ./web:/usr/src/app
